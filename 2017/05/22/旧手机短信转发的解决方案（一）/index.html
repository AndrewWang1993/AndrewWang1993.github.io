
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="AndrewWang&#39;s Blog">
    <title>旧手机短信转发的解决方案（一） - AndrewWang&#39;s Blog</title>
    <meta name="author" content="AndrewWang">
    
        <meta name="keywords" content="hexo,javascript,android,java,JS,Python,">
    
    
        <link rel="icon" href="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/favicon(8).png">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"AndrewWang","sameAs":["https://github.com/AndrewWang1993","https://stackoverflow.com/users/4209302/andrewwang","mailto:fernando_caudill@outlook.com"],"image":"https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png"},"articleBody":"解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。\nShortMessageBean.java123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263public class ShortMessageBean &#123;    private String content;    private String obsContent;    private int currentCount;    private int msgId;    public ShortMessageBean(String content, String obsContent, int currentCount, int msgId) &#123;        this.content = content;        this.obsContent = obsContent;        this.currentCount = currentCount;        this.msgId = msgId;    &#125;    public ShortMessageBean(String content, String obsContent) &#123;        this.content = content;        this.obsContent = obsContent;        this.currentCount = SMSAplication.MAX_RETRY_COUNT;        this.msgId = new Random().nextInt(Integer.MAX_VALUE);    &#125;    public String getContent() &#123;        return content;    &#125;    public void setContent(String content) &#123;        this.content = content;    &#125;    public String getObsContent() &#123;        return obsContent;    &#125;    public void setObsContent(String obsContent) &#123;        this.obsContent = obsContent;    &#125;    public int getCurrentCount() &#123;        return currentCount;    &#125;    public void setCurrentCount(int currentCount) &#123;        this.currentCount = currentCount;    &#125;    public int getMsgId() &#123;        return msgId;    &#125;    public void setMsgId(int msgId) &#123;        this.msgId = msgId;    &#125;    @Override    public String toString() &#123;        return &quot;ShortMessageBean&#123;&quot; +                &quot;content=&apos;&quot; + content + &apos;\\&apos;&apos; +                &quot;, obsContent=&apos;&quot; + obsContent + &apos;\\&apos;&apos; +                &quot;, currentCount=&quot; + currentCount +                &quot;, msgId=&quot; + msgId +                &apos;&#125;&apos;;    &#125;&#125;\nMainActivity.java\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472public class MainActivity extends Activity &#123;    Button mButtonClear;    Button mButtonSend;    TextView mSMSlogTextView;    EditText mEditText;    BroadcastReceiver mSMCommingReceiver, mScreenReceiver, mBatteryReceiver;    IntentFilter mSMSIntentFilter, mScreenIntentFilter, mBatteryFilter;    int currentDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);    SimpleDateFormat mSimpleDateFormat = new SimpleDateFormat(&quot;HH:mm:ss&quot;, Locale.getDefault());    private static final int MSG_NET_SEND = 1;    private static final int MSG_SMS_SEND = 2;    @SuppressLint(&quot;HandlerLeak&quot;)    Handler mHandler = new Handler() &#123;        @Override        public void handleMessage(Message msg) &#123;            final ShortMessageBean shortMessageBean = (ShortMessageBean) msg.obj;            final int currentCount = shortMessageBean.getCurrentCount();            final String content = shortMessageBean.getContent();            final String obsContent = shortMessageBean.getObsContent();            Logger.i(&quot;MESSAGE ID --&gt;&quot; + shortMessageBean.getMsgId());            switch (msg.what) &#123;                case MSG_NET_SEND:                    ArrayMap&lt;String, String&gt; params = new ArrayMap&lt;&gt;();                    params.put(&quot;msg&quot;, obsContent);                    RequestBody body = RequestBody.create(JSON, new JSONObject(params).toString());                    //避免重试时堆栈中还有此URL请求                    String randomURL = SERVER_URL + &quot;?id=&quot; + (new Random().nextInt(9999999) + 1);                    Request request = new Request.Builder()                            .url(randomURL)                            .post(body)                            .build();                    client.newCall(request).enqueue(new okhttp3.Callback() &#123;                        @Override                        public void onResponse(Call call, Response response) throws IOException &#123;                            if (response.isSuccessful()) &#123;                                try &#123;                                    JSONObject rspJson = new JSONObject(response.body().string());                                    final String divider;                                    String rspStr = rspJson.optString(&quot;rsp&quot;);                                    if (rspStr.contains(&quot;200&quot;)) &#123;                                        divider = NORMAL_DIVIDER;                                    &#125; else &#123;                                        divider = ABNORMAL_DIVIDER;                                    &#125;                                    Logger.i(&quot;SEND --&gt;&quot; + content);                                    //该回调不在主线程                                    MainActivity.this.runOnUiThread(new Runnable() &#123;                                        @Override                                        public void run() &#123;                                            checkClearScreen();                                            addTextViewMessage(mSMSlogTextView, divider +                                                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + content);                                        &#125;                                    &#125;);                                &#125; catch (JSONException e) &#123;                                    Logger.e(&quot;服务器返回Json格式异常&quot;);                                    e.printStackTrace();                                &#125;                            &#125; else &#123;                                Logger.e(&quot;服务器返回异常&quot;);                            &#125;                        &#125;                        @Override                        public void onFailure(Call call, IOException e) &#123;                            Logger.e(&quot;请求失败 &quot; + e.toString());                            if (currentCount &gt; 0) &#123;                                //如果网络已连接但是不通，尝试进行4G/WIFI切换                                if ((currentCount == 3) &amp;&amp; !ConnectivityUtils.isOnline2()) &#123;                                    Logger.e(&quot;NO NETWORK--&gt; COUNT &quot; + currentCount);                                    Logger.e(&quot;NO NETWORK--&gt;  try toggle wifi&quot;);                                    ConnectivityUtils.toggleWifi();                                &#125;                                Logger.e(&quot;ERROR COUNT: &quot; + currentCount);                                int delayTime = (MAX_RETRY_COUNT - currentCount) * RETRY_INTERVAL;                                shortMessageBean.setCurrentCount(currentCount - 1);                                send(MSG_NET_SEND, delayTime, shortMessageBean);                            &#125; else &#123;                                send(MSG_SMS_SEND, shortMessageBean);                            &#125;                        &#125;                    &#125;);                    break;                case MSG_SMS_SEND:                    sendByPhone(content);                    break;                default:                    break;            &#125;        &#125;    &#125;;    @Override    protected void onCreate(Bundle savedInstanceState) &#123;        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        setAllowNetWorkMainThread();        Logger.d(&quot;MainActivity CREATE&quot;);        mButtonClear = (Button) findViewById(R.id.button_clear);        mButtonSend = (Button) findViewById(R.id.button_send);        mSMSlogTextView = (TextView) findViewById(R.id.smsLogTextView);        mSMSlogTextView.setMovementMethod(new ScrollingMovementMethod());        mEditText = (EditText) findViewById(R.id.edit_text);        mButtonClear.setOnLongClickListener(new View.OnLongClickListener() &#123;            @Override            public boolean onLongClick(View v) &#123;                boolean isInputBarVisible = mEditText.getVisibility() == View.VISIBLE;                mEditText.setVisibility(isInputBarVisible ? View.GONE : View.VISIBLE);                if (!isInputBarVisible) &#123;                    mEditText.setText(SERVER_HOST + &quot;:&quot; + SERVER_PORT);                    return false;                &#125;                String url = mEditText.getText().toString().trim();                if (!TextUtils.isEmpty(url)) &#123;                    if (!url.contains(&quot;http&quot;)) &#123;                        Toast.makeText(getApplicationContext(), &quot;必须含有http或者https&quot;, Toast.LENGTH_SHORT).show();                        return false;                    &#125;                    String[] urlSplit = url.split(&quot;:&quot;);                    if (urlSplit.length == 2) &#123;                        SERVER_HOST = url;                        SERVER_PORT = 58585;                    &#125; else if (urlSplit.length == 3) &#123;                        SERVER_HOST = urlSplit[0] + &quot;:&quot; + urlSplit[1];                        SERVER_PORT = Integer.valueOf(urlSplit[2]);                    &#125; else &#123;                        Toast.makeText(getApplicationContext(), &quot;URL不合法&quot;, Toast.LENGTH_SHORT).show();                        return false;                    &#125;                &#125; else &#123;                    SERVER_HOST = SERVER_FIX_HOST;                    SERVER_PORT = 58585;                &#125;                SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;                SPStaticUtils.put(TAG_URL, SERVER_URL);                SPStaticUtils.put(TAG_HOST, SERVER_HOST);                SPStaticUtils.put(TAG_PORT, SERVER_PORT);                if (mEditText.getVisibility() == View.GONE) &#123;                    Toast.makeText(mApplication, SERVER_URL + &quot; 已生效&quot;, Toast.LENGTH_LONG).show();                &#125;                return false;            &#125;        &#125;);        mButtonSend.setOnLongClickListener(new View.OnLongClickListener() &#123;            @Override            public boolean onLongClick(View v) &#123;//                SERVER_HOST = SERVER_FIX_HOST;//                SERVER_PORT = 58585;//                SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;//                Toast.makeText(mApplication, SERVER_URL + &quot;已重置服务器地址&quot;, Toast.LENGTH_SHORT).show();                toggleServer(false);                finish();                android.os.Process.killProcess(android.os.Process.myPid());                return false;            &#125;        &#125;);        setBrocastReceiver();        setIntentFilter();        toggleServer(true);    &#125;    @Override    protected void onStart() &#123;        super.onStart();        PhoneCallReceiver.setOnRingListener(new PhoneCallReceiver.OnRingListener() &#123;            @Override            public void onIncomingCallReceived(Context ctx, String number, Date start) &#123;                sendIncomingRingMsg(number.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;-&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;));            &#125;            @Override            public void onIncomingCallAnswered(Context ctx, String number, Date start) &#123;            &#125;            @Override            public void onIncomingCallEnded(Context ctx, String number, Date start, Date end) &#123;            &#125;            @Override            public void onOutgoingCallStarted(Context ctx, String number, Date start) &#123;            &#125;            @Override            public void onOutgoingCallEnded(Context ctx, String number, Date start, Date end) &#123;            &#125;            @Override            public void onMissedCall(Context ctx, String number, Date start) &#123;            &#125;        &#125;);    &#125;    @Override    protected void onResume() &#123;        super.onResume();        Logger.i(&quot;MainActivity RESUME&quot;);        registerReceiver(mSMCommingReceiver, mSMSIntentFilter);        registerReceiver(mScreenReceiver, mScreenIntentFilter);        registerReceiver(mBatteryReceiver, mBatteryFilter);    &#125;    @Override    protected void onPause() &#123;        super.onPause();        Logger.i(&quot;MainActivity PAUSE&quot;);    &#125;    @Override    protected void onStop() &#123;        super.onStop();        Logger.i(&quot;MainActivity STOP&quot;);    &#125;    @Override    protected void onDestroy() &#123;        super.onDestroy();        Logger.i(&quot;MainActivity DESTORY&quot;);        unregisterReceiver(mSMCommingReceiver);        unregisterReceiver(mScreenReceiver);        unregisterReceiver(mBatteryReceiver);    &#125;    private void setBrocastReceiver() &#123;        mSMCommingReceiver = new BroadcastReceiver() &#123;            @Override            public void onReceive(Context context, Intent intent) &#123;                String msg_from = &quot;&quot;;                StringBuilder msgBodyStringBuilder = new StringBuilder(200);                Bundle bundle = intent.getExtras();                SmsMessage[] msgs;                if (bundle != null) &#123;                    try &#123;                        Object[] pdus = (Object[]) bundle.get(&quot;pdus&quot;);                        assert pdus != null;                        msgs = new SmsMessage[pdus.length];                        for (int i = 0; i &lt; msgs.length; i++) &#123;                            msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);                            msg_from = msgs[i].getOriginatingAddress();                            msgBodyStringBuilder.append(msgs[i].getMessageBody());                        &#125;                        String name = SMSAplication.sPhoneContactMap                                .get(msg_from.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;-&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;));                        if (!TextUtils.isEmpty(name)) &#123;                            msgBodyStringBuilder.insert(0, name + &quot;-&gt; &quot;);                        &#125;                        String content = msg_from + &quot;\\n&quot; + msgBodyStringBuilder.toString();                        //回应飞信消息                        if (content.contains(&quot;%YG8Cf^17R*GqzVfxXHP2e&quot;) &amp;&amp; content.contains(&quot;查询手机状态信息&quot;)) &#123;                            sendStatusMsg();                            return;                        &#125;                        if (content.contains(&quot;s*Yfb3SdXy9ruUBK8R!gZX&quot;) &amp;&amp; content.contains(&quot;设置网络&quot;)) &#123;                            setNetMsg(content);                            return;                        &#125;                        send(MSG_NET_SEND,                                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyStringBuilder.toString())));                    &#125; catch (Exception e) &#123;                        Logger.e(e.getMessage());                    &#125;                &#125;            &#125;        &#125;;        mScreenReceiver = new BroadcastReceiver() &#123;            @Override            public void onReceive(Context context, Intent intent) &#123;                Logger.i(intent.getAction());                if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) &#123;                    Intent starKeepActivityIntent = new Intent(MainActivity.this, KeepLiveActivity.class);                    startActivity(starKeepActivityIntent);                &#125;            &#125;        &#125;;        mBatteryReceiver = new BroadcastReceiver() &#123;            @Override            public void onReceive(Context context, Intent batteryIntent) &#123;                Logger.i(batteryIntent.getAction());                if (batteryIntent.getAction().equals(Intent.ACTION_BATTERY_LOW)) &#123;                    sendStatusMsg();                &#125;            &#125;        &#125;;    &#125;    private void setAllowNetWorkMainThread() &#123;        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();        StrictMode.setThreadPolicy(policy);    &#125;    private void setNetMsg(String msg) &#123;        String msg_from = &quot;66666666&quot;;        String msgBodyString = &quot;设置网络 &quot;;        if (msg.contains(&quot;4G&quot;)) &#123;            msgBodyString += &quot;4G&quot;;            ConnectivityUtils.setWifi(false);        &#125; else if (msg.contains(&quot;WIFI&quot;)) &#123;            msgBodyString += &quot;WIFI&quot;;            ConnectivityUtils.setWifi(true);        &#125; else &#123;            msgBodyString += &quot;NONE&quot;;        &#125;        String content = msg_from + &quot;\\n&quot; + msgBodyString;        Logger.i(content);        send(MSG_NET_SEND,                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));    &#125;    private void sendStatusMsg() &#123;        String msg_from = &quot;88888888&quot;;        String msgBodyString = &quot;当前电量 &quot; + CommonUtils.getBatteryLevel() + &quot; %&quot;;        msgBodyString += &quot;\\n网络信息 &quot; + ConnectivityUtils.getConnectedInfo(SMSAplication.mApplication);        msgBodyString += &quot;\\n连通信息 &quot; + ConnectivityUtils.isOnline2();        String content = msg_from + &quot;\\n&quot; + msgBodyString;        Logger.i(content);        send(MSG_NET_SEND,                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));    &#125;    private void sendIncomingRingMsg(String number) &#123;        String msg_from = number;        String msgBodyString = &quot;【来电提醒】 &quot; + number;        String name = SMSAplication.sPhoneContactMap.get(number);        if (!TextUtils.isEmpty(name)) &#123;            msgBodyString = &quot;【来电提醒】-&gt;&quot; + name;        &#125;        String content = msg_from + &quot;\\n&quot; + msgBodyString;        Logger.i(content);        send(MSG_NET_SEND,                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));    &#125;    private void setIntentFilter() &#123;        mSMSIntentFilter = new IntentFilter(&quot;android.provider.Telephony.SMS_RECEIVED&quot;);        mSMSIntentFilter.setPriority(1000);        mScreenIntentFilter = new IntentFilter(Intent.ACTION_SCREEN_OFF);        mScreenIntentFilter.setPriority(1000);        mBatteryFilter = new IntentFilter(Intent.ACTION_BATTERY_LOW);        mBatteryFilter.setPriority(1000);    &#125;    private void toggleServer(boolean start) &#123;        Intent serverIntent = new Intent(getApplicationContext(), KeepLiveServer.class);        serverIntent.putExtra(&quot;status&quot;, start ? &quot;start&quot; : &quot;stop&quot;);        startService(serverIntent);    &#125;    private void send(int what, ShortMessageBean shortMessageBean) &#123;        Message message = mHandler.obtainMessage(what);        message.obj = shortMessageBean;        message.sendToTarget();    &#125;    private void send(int what, int delay, ShortMessageBean shortMessageBean) &#123;        Message message = new Message();        message.what = what;        message.obj = shortMessageBean;        mHandler.sendMessageDelayed(message, delay);    &#125;    /**     * 由本机发送     *     * @param content sms content     */    synchronized private void sendByPhone(String content) &#123;        int nowDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);        if (nowDay != SMSAplication.sCurrentDay) &#123;            SMSAplication.sSMSByPhoneTodayCount = 0;            SMSAplication.sCurrentDay = nowDay;        &#125;        //如果使用短信，每天发送超过10条        if (SMSAplication.sSMSByPhoneTodayCount &gt; SMSAplication.MAX_SMS_BY_PHONE_COUNT) &#123;            addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;使用短信发送超过每日限制 !!!!!!\\n&quot;                    + content);            Logger.e(&quot;使用短信发送超过每日限制 : &quot; + content);            return;        &#125;        // 如果是验证码短信则本机发送        if ((content.contains(&quot;动态&quot;) || content.contains(&quot;验证&quot;)) &amp;&amp; (!content.contains(&quot;Test__&quot;))) &#123;            if (TextUtils.isEmpty(SMSAplication.sCurrentPhoneNum)) &#123;                CommonUtils.sendLongSMS(SMSAplication.S_PHONE_NUMBER_POOLS[0], content);                addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +                        mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;验证码使用短信发送 !!!!!!\\n&quot;                        + content);                Logger.e(&quot;验证码使用短信发送: &quot; + content);            &#125; else &#123;                for (String num : SMSAplication.S_PHONE_NUMBER_POOLS) &#123;                    if (!SMSAplication.sCurrentPhoneNum.contains(num)) &#123;                        CommonUtils.sendLongSMS(num, content);                        addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +                                mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;验证码使用短信发送 !!!!!!\\n&quot;                                + content);                        Logger.e(&quot;验证码使用短信发送: &quot; + content);                    &#125;                &#125;            &#125;            SMSAplication.sSMSByPhoneTodayCount++;        &#125; else &#123;            addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;非验证码不使用短信发送 !!!!!!\\n&quot;                    + content);            Logger.e(&quot;非验证码不使用短信发送 : &quot; + content);        &#125;    &#125;    @Override    public void onBackPressed() &#123;    &#125;    public void clear(View view) &#123;        mSMSlogTextView.setText(&quot;&quot;);    &#125;    public void checkClearScreen() &#123;        int nowDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);        if (nowDay != currentDay) &#123;            mSMSlogTextView.setText(&quot;&quot;);            currentDay = nowDay;        &#125;    &#125;    public void stimulateSend(View view) &#123;        String msg_from = TEST_SMS_FROM[new Random().nextInt(TEST_SMS_FROM.length)];        String msgBodyString = TEST_SMS_BODY[new Random().nextInt(TEST_SMS_BODY.length)];        String content = msg_from + &quot;\\n&quot; + msgBodyString;        ShortMessageBean shortMessageBean = new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString));        send(MSG_NET_SEND, shortMessageBean);        Toast.makeText(mApplication, &quot;模拟接收到短信&quot;, Toast.LENGTH_SHORT).show();    &#125;    private void addTextViewMessage(TextView mTextView, String msg) &#123;        mTextView.append(msg);        final int scrollAmount =                mTextView.getLayout().getLineTop(mTextView.getLineCount()) - mTextView.getHeight();        if (scrollAmount &gt; 0)            mTextView.scrollTo(0, scrollAmount);        else            mTextView.scrollTo(0, 0);    &#125;&#125;\nSMSAplication.java\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899public class SMSAplication extends Application &#123;    public static Application mApplication;    public static final String SERVER_FIX_HOST = &quot;https://m.xiaoming666.ml&quot;;    public static String SERVER_HOST = SERVER_FIX_HOST;    public static int SERVER_PORT = 58585;    public static String SERVER_PATH = &quot;/Cbu8xatUFAAjqbS33bduWNuxpEe9fJGZ/api/push_sms&quot;;    public static String SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;    public static String TAG_HOST = &quot;TAG_HOST&quot;;    public static String TAG_PORT = &quot;TAG_PORT&quot;;    public static String TAG_URL = &quot;TAG_URL&quot;;    public static HashMap&lt;String, String&gt; sPhoneContactMap;    public static String sCurrentPhoneNum;    public final static String[] S_PHONE_NUMBER_POOLS = &#123;&quot;17625756770&quot;, &quot;13926520602&quot;&#125;;    public final static int MAX_SMS_BY_PHONE_COUNT = 10;    volatile public static int sSMSByPhoneTodayCount = 0; // 没网状态每天最多发送10条验证码短信    volatile public static int sCurrentDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);    public static final int MAX_RETRY_COUNT = 6;    public static final int RETRY_INTERVAL = 2000;    public static final String NORMAL_DIVIDER = &quot;\\n----------------------------------\\n&quot;;    public static final String ABNORMAL_DIVIDER = &quot;\\n************************************\\n&quot;;    public static final String TEST_SMS_FROM[] = &#123;            &quot;10086&quot;, &quot;10690691036509&quot;, &quot;10584156&quot;,            &quot;10086&quot;, &quot;10690691036509&quot;, &quot;10584156&quot;&#125;;    public static final String TEST_SMS_BODY[] = &#123;            &quot;Test__尊敬的客户：您当前账户余额19.57元，下一个月结日为2017年07月01日。如需充值可点击 http://gd.10086.cn/cz 。【中国移动】&quot;,            &quot;Test__【百度】588662 (动态验证码),请在30分钟内填写&quot;,            &quot;Test__【新浪网】感谢您选择新浪云。接下来的日子，我们将全力协助您，并与您携手一起用技术和创意改变世界！，退订回T&quot;,            &quot;Test__【平台机器人】您的验证码是：981348（十分钟内有效）。请不要把验证码泄露给其他人。&quot;,            &quot;Test__【美团网】506820（换绑手机验证码）。工作人员不会向您索要，请勿向任何人泄露。&quot;,            &quot;Test__【每日优鲜】&lt;满59减30&gt;红包送你！超级会员周，会员专享商品最高直降30元，还不快抢→ http://t.cn/Ra20SNB 退订TD&quot;,            &quot;Test__每周五上午10点，持浦发银行卡在食行生鲜APP平台充值并在线支付，即可享受满100元返50元优惠&quot;&#125;;    public static OkHttpClient client = new OkHttpClient.Builder()            .connectTimeout(6, TimeUnit.SECONDS)            .writeTimeout(6, TimeUnit.SECONDS)            .readTimeout(6, TimeUnit.SECONDS)            .retryOnConnectionFailure(false)            .build();    public static final MediaType JSON            = MediaType.parse(&quot;application/json; charset=utf-8&quot;);    @Override    public void onCreate() &#123;        super.onCreate();        mApplication = this;        setLogger();        new Thread(new Runnable() &#123;            @Override            public void run() &#123;                sPhoneContactMap = CommonUtils.getAllContactInfo();                TelephonyManager tMgr = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);                sCurrentPhoneNum = tMgr.getLine1Number();                if (!TextUtils.isEmpty(sCurrentPhoneNum)) &#123;                    sCurrentPhoneNum = sCurrentPhoneNum.replace(&quot; &quot;, &quot;&quot;)                            .replace(&quot;+86&quot;, &quot;&quot;);                &#125;            &#125;        &#125;).start();        String host = SPStaticUtils.getString(TAG_HOST);        int port = SPStaticUtils.getInt(TAG_PORT);        String url = SPStaticUtils.getString(TAG_URL);        if (TextUtils.isEmpty(url)) &#123;            SPStaticUtils.put(TAG_URL, SERVER_URL);            SPStaticUtils.put(TAG_HOST, SERVER_HOST);            SPStaticUtils.put(TAG_PORT, SERVER_PORT);        &#125; else &#123;            SERVER_HOST = host;            SERVER_PORT = port;            SERVER_URL = url;        &#125;    &#125;    private void setLogger() &#123;        Logger.addLogAdapter(new AndroidLogAdapter());        Logger.addLogAdapter(new AndroidLogAdapter() &#123;            @Override            public boolean isLoggable(int priority, String tag) &#123;                return BuildConfig.DEBUG;            &#125;        &#125;);        FormatStrategy formatStrategy = PrettyFormatStrategy.newBuilder()                .showThreadInfo(true)  // (Optional) Whether to show thread info or not. Default true                .methodCount(2)         // (Optional) How many method line to show. Default 2                .methodOffset(0)        // (Optional) Hides internal method calls up to offset. Default 5                .tag(&quot;PeoceWang&quot;)   // (Optional) Global tag for every log. Default PRETTY_LOGGER                .build();        Logger.addLogAdapter(new AndroidLogAdapter(formatStrategy));        Logger.addLogAdapter(new DiskLogAdapter());    &#125;&#125;\nEncryptUtils.java\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155public class EncryptUtils &#123;    private static String s_AES_KEY = &quot;0@NSfpy#L9@ec%NZyZ7Jz5mD@xI$B#2r&quot;;    private static String a_AES_IV = &quot;6aStDl7YrB4CM3gq&quot;;    private static String OBSCURE_KEY[] = &#123;&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;,            &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;, &quot;L&quot;, &quot;M&quot;,            &quot;N&quot;, &quot;O&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;R&quot;, &quot;S&quot;, &quot;T&quot;, &quot;U&quot;, &quot;V&quot;, &quot;W&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;,            &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;,            &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;,            &quot;+&quot;, &quot;=&quot;    &#125;;    private static String OBSCURE_VALUE1[] = &#123;&quot;a&quot;, &quot;Z&quot;, &quot;=&quot;, &quot;I&quot;, &quot;j&quot;, &quot;w&quot;, &quot;9&quot;, &quot;B&quot;, &quot;v&quot;, &quot;+&quot;, &quot;f&quot;, &quot;g&quot;, &quot;1&quot;, &quot;6&quot;, &quot;y&quot;, &quot;N&quot;, &quot;C&quot;, &quot;4&quot;, &quot;k&quot;, &quot;t&quot;, &quot;O&quot;, &quot;m&quot;, &quot;e&quot;,            &quot;l&quot;,            &quot;q&quot;, &quot;3&quot;, &quot;R&quot;, &quot;u&quot;, &quot;8&quot;, &quot;7&quot;, &quot;S&quot;, &quot;2&quot;, &quot;Q&quot;, &quot;0&quot;, &quot;P&quot;, &quot;c&quot;, &quot;5&quot;, &quot;H&quot;, &quot;r&quot;, &quot;G&quot;, &quot;E&quot;, &quot;b&quot;, &quot;J&quot;, &quot;W&quot;, &quot;o&quot;, &quot;M&quot;, &quot;K&quot;,            &quot;i&quot;,            &quot;U&quot;, &quot;x&quot;, &quot;L&quot;, &quot;V&quot;, &quot;z&quot;, &quot;F&quot;, &quot;Y&quot;, &quot;n&quot;, &quot;X&quot;, &quot;A&quot;, &quot;p&quot;, &quot;T&quot;, &quot;s&quot;, &quot;D&quot;, &quot;d&quot;, &quot;h&quot;    &#125;;    private static String OBSCURE_VALUE2[] = &#123;&quot;i&quot;, &quot;z&quot;, &quot;+&quot;, &quot;1&quot;, &quot;M&quot;, &quot;y&quot;, &quot;t&quot;, &quot;Z&quot;, &quot;e&quot;, &quot;C&quot;, &quot;3&quot;, &quot;6&quot;, &quot;w&quot;, &quot;D&quot;, &quot;5&quot;, &quot;O&quot;, &quot;o&quot;, &quot;L&quot;, &quot;v&quot;, &quot;u&quot;, &quot;0&quot;, &quot;P&quot;, &quot;j&quot;,            &quot;Q&quot;,            &quot;Y&quot;, &quot;s&quot;, &quot;U&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;x&quot;, &quot;m&quot;, &quot;h&quot;, &quot;F&quot;, &quot;T&quot;, &quot;q&quot;, &quot;p&quot;, &quot;W&quot;, &quot;8&quot;, &quot;I&quot;, &quot;d&quot;, &quot;n&quot;, &quot;H&quot;, &quot;4&quot;, &quot;f&quot;, &quot;a&quot;, &quot;c&quot;,            &quot;V&quot;,            &quot;=&quot;, &quot;E&quot;, &quot;b&quot;, &quot;9&quot;, &quot;S&quot;, &quot;2&quot;, &quot;l&quot;, &quot;r&quot;, &quot;k&quot;, &quot;N&quot;, &quot;K&quot;, &quot;X&quot;, &quot;J&quot;, &quot;7&quot;, &quot;R&quot;, &quot;g&quot;    &#125;;    private static String OBSCURE_VALUE3[] = &#123;&quot;A&quot;, &quot;3&quot;, &quot;F&quot;, &quot;=&quot;, &quot;Z&quot;, &quot;c&quot;, &quot;T&quot;, &quot;p&quot;, &quot;s&quot;, &quot;L&quot;, &quot;i&quot;, &quot;+&quot;, &quot;5&quot;, &quot;7&quot;, &quot;j&quot;, &quot;R&quot;, &quot;l&quot;, &quot;d&quot;, &quot;q&quot;, &quot;I&quot;, &quot;m&quot;, &quot;D&quot;, &quot;h&quot;,            &quot;M&quot;,            &quot;P&quot;, &quot;U&quot;, &quot;x&quot;, &quot;z&quot;, &quot;W&quot;, &quot;8&quot;, &quot;K&quot;, &quot;S&quot;, &quot;E&quot;, &quot;0&quot;, &quot;Q&quot;, &quot;X&quot;, &quot;r&quot;, &quot;e&quot;, &quot;2&quot;, &quot;k&quot;, &quot;6&quot;, &quot;g&quot;, &quot;1&quot;, &quot;9&quot;, &quot;O&quot;, &quot;J&quot;, &quot;V&quot;,            &quot;f&quot;,            &quot;t&quot;, &quot;N&quot;, &quot;Y&quot;, &quot;o&quot;, &quot;H&quot;, &quot;v&quot;, &quot;w&quot;, &quot;n&quot;, &quot;G&quot;, &quot;4&quot;, &quot;u&quot;, &quot;B&quot;, &quot;C&quot;, &quot;a&quot;, &quot;y&quot;, &quot;b&quot;    &#125;;    private static ArrayMap OBSCURE_MAP1 = new ArrayMap();    private static ArrayMap OBSCURE_MAP2 = new ArrayMap();    private static ArrayMap OBSCURE_MAP3 = new ArrayMap();    private static final int[] INSERT_POSITION = &#123;0, 5, 7, 9, 22, 30, 31, 35, 39, 42&#125;;    private static final int[] INSERT_MSG_LEN = &#123;7, 12, 10, 6, 9, 6, 10, 8, 9, 4&#125;;    private static ArrayMap&lt;Integer, Integer&gt; POS_LEN_MAP = new ArrayMap();    static &#123;        int len = OBSCURE_KEY.length;        for (int i = 0; i &lt; len; i++) &#123;            OBSCURE_MAP1.put(OBSCURE_KEY[i], OBSCURE_VALUE1[i]);            OBSCURE_MAP2.put(OBSCURE_KEY[i], OBSCURE_VALUE2[i]);            OBSCURE_MAP3.put(OBSCURE_KEY[i], OBSCURE_VALUE3[i]);        &#125;        len = INSERT_POSITION.length;        for (int i = 0; i &lt; len; i++) &#123;            POS_LEN_MAP.put(INSERT_POSITION[i], INSERT_MSG_LEN[i]);        &#125;    &#125;    public static String encrypt(String from, String body) &#123;        ArrayMap&lt;String, String&gt; arrayMap = new ArrayMap(2);        arrayMap.put(&quot;FROM&quot;, from);        arrayMap.put(&quot;BODY&quot;, body);        try &#123;            return obscureString(getBase64Encode(map2Json(arrayMap).toString()));        &#125; catch (Exception e) &#123;            e.printStackTrace();        &#125;        return &quot;ENCRYPT ERROR!!!&quot;;    &#125;    private static String getBase64Encode(String plainStr) &#123;        return Base64.encodeToString(plainStr.getBytes(), Base64.NO_WRAP);    &#125;    private static String replaceChar(String plainString, ArrayMap arrayMap) &#123;        StringBuilder stringBuilder = new StringBuilder();        int stringLen = plainString.length();        for (int i = 0; i &lt; stringLen; i++) &#123;            String c = String.valueOf(plainString.charAt(i));            if (arrayMap.containsKey(c)) &#123;                stringBuilder.append(arrayMap.get(c));            &#125; else &#123;                stringBuilder.append(c);            &#125;        &#125;        return stringBuilder.toString();    &#125;    private static String getRandomString(int len) &#123;        StringBuilder stringBuilder = new StringBuilder(len);        for (int i = 0; i &lt; len; i++) &#123;            stringBuilder.append((char) (&apos;(&apos; + new Random().nextInt(50)));        &#125;        return stringBuilder.toString();    &#125;    private static String addReduceChar(String plainString) &#123;        StringBuilder stringBuilder = new StringBuilder(plainString);        for (int pos : INSERT_POSITION) &#123;            stringBuilder.insert(pos, getRandomString(POS_LEN_MAP.get(pos)));        &#125;        return stringBuilder.toString();    &#125;    public static String removeReduceChar(String plainString) &#123;        StringBuilder stringBuilder = new StringBuilder(plainString);        int len = INSERT_POSITION.length;        for (int i = len - 1; i &gt;= 0; i--) &#123;            String firstStr = stringBuilder.substring(0, INSERT_POSITION[i]);            String secondStr = stringBuilder.substring(INSERT_POSITION[i] + INSERT_MSG_LEN[i], stringBuilder.length());            stringBuilder = new StringBuilder(firstStr + secondStr);        &#125;        return stringBuilder.toString();    &#125;    //   加密过程：    //   原文--&gt; Json -&gt; Base64--&gt; AES(CBC) --&gt; 一轮字符替换 --&gt; 二轮字符替换  --&gt; 指定位置添加冗余信息 --&gt; 三轮字符替换  --&gt; 密文    private static String obscureString(String plainString) throws Exception &#123;        String obsString = aesEncrypt(plainString);        obsString = replaceChar(obsString, OBSCURE_MAP1);        obsString = replaceChar(obsString, OBSCURE_MAP2);        obsString = addReduceChar(obsString);        obsString = replaceChar(obsString, OBSCURE_MAP3);        return obsString;    &#125;    private static String aesEncrypt(String sSrc) throws Exception &#123;        Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);        byte[] raw = s_AES_KEY.getBytes();        SecretKeySpec skeySpec = new SecretKeySpec(raw, &quot;AES&quot;);        IvParameterSpec iv = new IvParameterSpec(a_AES_IV.getBytes());//使用CBC模式，需要一个向量iv，可增加加密算法的强度        cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);        byte[] encrypted = cipher.doFinal(sSrc.getBytes(&quot;utf-8&quot;));//        return new BASE64Encoder().encode(encrypted);//此处使用BASE64做转码。        StringBuilder sb = new StringBuilder();  //此处使用十六进制转码。        for (byte b : encrypted) &#123;            sb.append(String.format(&quot;%02X&quot;, b));        &#125;        return sb.toString();    &#125;    public static String aesDecrypt(String sSrc) throws Exception &#123;//        try &#123;//            byte[] raw = sKey.getBytes(&quot;ASCII&quot;);//            SecretKeySpec skeySpec = new SecretKeySpec(raw, &quot;AES&quot;);//            Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);//            IvParameterSpec iv = new IvParameterSpec(ivParameter.getBytes());//            cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);//            byte[] encrypted1 = new BASE64Decoder().decodeBuffer(sSrc);//先用base64解密//            byte[] original = cipher.doFinal(encrypted1);//            String originalString = new String(original, &quot;utf-8&quot;);//            return originalString;//        &#125; catch (Exception ex) &#123;//            return null;//        &#125;        return null;    &#125;&#125;","dateCreated":"2017-05-22T16:10:00+08:00","dateModified":"2020-11-24T09:30:47+08:00","datePublished":"2017-05-22T16:10:00+08:00","description":"解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。","headline":"旧手机短信转发的解决方案（一）","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/"},"publisher":{"@type":"Organization","name":"AndrewWang","sameAs":["https://github.com/AndrewWang1993","https://stackoverflow.com/users/4209302/andrewwang","mailto:fernando_caudill@outlook.com"],"image":"https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png","logo":{"@type":"ImageObject","url":"https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png"}},"url":"https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/","keywords":"Wechat, 双卡功能"}</script>
    <meta name="description" content="解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。">
<meta name="keywords" content="Wechat,双卡功能">
<meta property="og:type" content="blog">
<meta property="og:title" content="旧手机短信转发的解决方案（一）">
<meta property="og:url" content="https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/index.html">
<meta property="og:site_name" content="AndrewWang&#39;s Blog">
<meta property="og:description" content="解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-11-24T01:30:47.687Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="旧手机短信转发的解决方案（一）">
<meta name="twitter:description" content="解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。">
<meta name="twitter:creator" content="@https:&#x2F;&#x2F;twitter.com&#x2F;JamesMcMurr">
    
    
        
    
    
        <meta property="og:image" content="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">AndrewWang&#39;s Blog</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png" alt="Author&#39;s picture">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png" alt="Author&#39;s picture">
                </a>
                <h4 class="sidebar-profile-name">AndrewWang</h4>
                
                    <h5 class="sidebar-profile-bio"><p>凡是过去，皆为序章<br>须知参差百态，乃是幸福本源<br>邮箱：<a href="mailto:fernando_caudill@outlook.com" target="_blank">fernando_caudill@outlook.com</a></p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="Home">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="Categories">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="Tags">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" title="Archives">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="#search" title="Search">
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="About">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/AndrewWang1993" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://stackoverflow.com/users/4209302/andrewwang" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="mailto:fernando_caudill@outlook.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/atom.xml" title="RSS">
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            旧手机短信转发的解决方案（一）
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2017-05-22T16:10:00+08:00">
	
		    May 22, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>, <a class="category-link" href="/categories/Android/Python/">Python</a>, <a class="category-link" href="/categories/Android/Python/Wechat/">Wechat</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>解决iphone只能单卡单待问题 转发安卓手机收到的短信到Python服务器，Python服务器在转发到个人的微信账号，这样就不用出门带着旧手机了。<br><a id="more"></a></p>
<p>ShortMessageBean.java<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">public class ShortMessageBean &#123;</span><br><span class="line"></span><br><span class="line">    private String content;</span><br><span class="line">    private String obsContent;</span><br><span class="line">    private int currentCount;</span><br><span class="line">    private int msgId;</span><br><span class="line"></span><br><span class="line">    public ShortMessageBean(String content, String obsContent, int currentCount, int msgId) &#123;</span><br><span class="line">        this.content = content;</span><br><span class="line">        this.obsContent = obsContent;</span><br><span class="line">        this.currentCount = currentCount;</span><br><span class="line">        this.msgId = msgId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ShortMessageBean(String content, String obsContent) &#123;</span><br><span class="line">        this.content = content;</span><br><span class="line">        this.obsContent = obsContent;</span><br><span class="line">        this.currentCount = SMSAplication.MAX_RETRY_COUNT;</span><br><span class="line">        this.msgId = new Random().nextInt(Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getContent() &#123;</span><br><span class="line">        return content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setContent(String content) &#123;</span><br><span class="line">        this.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getObsContent() &#123;</span><br><span class="line">        return obsContent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setObsContent(String obsContent) &#123;</span><br><span class="line">        this.obsContent = obsContent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getCurrentCount() &#123;</span><br><span class="line">        return currentCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setCurrentCount(int currentCount) &#123;</span><br><span class="line">        this.currentCount = currentCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getMsgId() &#123;</span><br><span class="line">        return msgId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setMsgId(int msgId) &#123;</span><br><span class="line">        this.msgId = msgId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;ShortMessageBean&#123;&quot; +</span><br><span class="line">                &quot;content=&apos;&quot; + content + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, obsContent=&apos;&quot; + obsContent + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, currentCount=&quot; + currentCount +</span><br><span class="line">                &quot;, msgId=&quot; + msgId +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MainActivity.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">    Button mButtonClear;</span><br><span class="line">    Button mButtonSend;</span><br><span class="line">    TextView mSMSlogTextView;</span><br><span class="line">    EditText mEditText;</span><br><span class="line">    BroadcastReceiver mSMCommingReceiver, mScreenReceiver, mBatteryReceiver;</span><br><span class="line">    IntentFilter mSMSIntentFilter, mScreenIntentFilter, mBatteryFilter;</span><br><span class="line"></span><br><span class="line">    int currentDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);</span><br><span class="line">    SimpleDateFormat mSimpleDateFormat = new SimpleDateFormat(&quot;HH:mm:ss&quot;, Locale.getDefault());</span><br><span class="line"></span><br><span class="line">    private static final int MSG_NET_SEND = 1;</span><br><span class="line">    private static final int MSG_SMS_SEND = 2;</span><br><span class="line"></span><br><span class="line">    @SuppressLint(&quot;HandlerLeak&quot;)</span><br><span class="line">    Handler mHandler = new Handler() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void handleMessage(Message msg) &#123;</span><br><span class="line">            final ShortMessageBean shortMessageBean = (ShortMessageBean) msg.obj;</span><br><span class="line">            final int currentCount = shortMessageBean.getCurrentCount();</span><br><span class="line">            final String content = shortMessageBean.getContent();</span><br><span class="line">            final String obsContent = shortMessageBean.getObsContent();</span><br><span class="line">            Logger.i(&quot;MESSAGE ID --&gt;&quot; + shortMessageBean.getMsgId());</span><br><span class="line">            switch (msg.what) &#123;</span><br><span class="line">                case MSG_NET_SEND:</span><br><span class="line">                    ArrayMap&lt;String, String&gt; params = new ArrayMap&lt;&gt;();</span><br><span class="line">                    params.put(&quot;msg&quot;, obsContent);</span><br><span class="line"></span><br><span class="line">                    RequestBody body = RequestBody.create(JSON, new JSONObject(params).toString());</span><br><span class="line">                    //避免重试时堆栈中还有此URL请求</span><br><span class="line">                    String randomURL = SERVER_URL + &quot;?id=&quot; + (new Random().nextInt(9999999) + 1);</span><br><span class="line">                    Request request = new Request.Builder()</span><br><span class="line">                            .url(randomURL)</span><br><span class="line">                            .post(body)</span><br><span class="line">                            .build();</span><br><span class="line"></span><br><span class="line">                    client.newCall(request).enqueue(new okhttp3.Callback() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void onResponse(Call call, Response response) throws IOException &#123;</span><br><span class="line">                            if (response.isSuccessful()) &#123;</span><br><span class="line">                                try &#123;</span><br><span class="line">                                    JSONObject rspJson = new JSONObject(response.body().string());</span><br><span class="line">                                    final String divider;</span><br><span class="line">                                    String rspStr = rspJson.optString(&quot;rsp&quot;);</span><br><span class="line">                                    if (rspStr.contains(&quot;200&quot;)) &#123;</span><br><span class="line">                                        divider = NORMAL_DIVIDER;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        divider = ABNORMAL_DIVIDER;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    Logger.i(&quot;SEND --&gt;&quot; + content);</span><br><span class="line">                                    //该回调不在主线程</span><br><span class="line">                                    MainActivity.this.runOnUiThread(new Runnable() &#123;</span><br><span class="line">                                        @Override</span><br><span class="line">                                        public void run() &#123;</span><br><span class="line">                                            checkClearScreen();</span><br><span class="line">                                            addTextViewMessage(mSMSlogTextView, divider +</span><br><span class="line">                                                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + content);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;);</span><br><span class="line">                                &#125; catch (JSONException e) &#123;</span><br><span class="line">                                    Logger.e(&quot;服务器返回Json格式异常&quot;);</span><br><span class="line">                                    e.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                Logger.e(&quot;服务器返回异常&quot;);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        @Override</span><br><span class="line">                        public void onFailure(Call call, IOException e) &#123;</span><br><span class="line">                            Logger.e(&quot;请求失败 &quot; + e.toString());</span><br><span class="line">                            if (currentCount &gt; 0) &#123;</span><br><span class="line">                                //如果网络已连接但是不通，尝试进行4G/WIFI切换</span><br><span class="line">                                if ((currentCount == 3) &amp;&amp; !ConnectivityUtils.isOnline2()) &#123;</span><br><span class="line">                                    Logger.e(&quot;NO NETWORK--&gt; COUNT &quot; + currentCount);</span><br><span class="line">                                    Logger.e(&quot;NO NETWORK--&gt;  try toggle wifi&quot;);</span><br><span class="line">                                    ConnectivityUtils.toggleWifi();</span><br><span class="line">                                &#125;</span><br><span class="line">                                Logger.e(&quot;ERROR COUNT: &quot; + currentCount);</span><br><span class="line">                                int delayTime = (MAX_RETRY_COUNT - currentCount) * RETRY_INTERVAL;</span><br><span class="line">                                shortMessageBean.setCurrentCount(currentCount - 1);</span><br><span class="line">                                send(MSG_NET_SEND, delayTime, shortMessageBean);</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                send(MSG_SMS_SEND, shortMessageBean);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    break;</span><br><span class="line">                case MSG_SMS_SEND:</span><br><span class="line">                    sendByPhone(content);</span><br><span class="line">                    break;</span><br><span class="line">                default:</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        setAllowNetWorkMainThread();</span><br><span class="line">        Logger.d(&quot;MainActivity CREATE&quot;);</span><br><span class="line"></span><br><span class="line">        mButtonClear = (Button) findViewById(R.id.button_clear);</span><br><span class="line">        mButtonSend = (Button) findViewById(R.id.button_send);</span><br><span class="line">        mSMSlogTextView = (TextView) findViewById(R.id.smsLogTextView);</span><br><span class="line">        mSMSlogTextView.setMovementMethod(new ScrollingMovementMethod());</span><br><span class="line">        mEditText = (EditText) findViewById(R.id.edit_text);</span><br><span class="line">        mButtonClear.setOnLongClickListener(new View.OnLongClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onLongClick(View v) &#123;</span><br><span class="line">                boolean isInputBarVisible = mEditText.getVisibility() == View.VISIBLE;</span><br><span class="line">                mEditText.setVisibility(isInputBarVisible ? View.GONE : View.VISIBLE);</span><br><span class="line">                if (!isInputBarVisible) &#123;</span><br><span class="line">                    mEditText.setText(SERVER_HOST + &quot;:&quot; + SERVER_PORT);</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">                String url = mEditText.getText().toString().trim();</span><br><span class="line">                if (!TextUtils.isEmpty(url)) &#123;</span><br><span class="line">                    if (!url.contains(&quot;http&quot;)) &#123;</span><br><span class="line">                        Toast.makeText(getApplicationContext(), &quot;必须含有http或者https&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        return false;</span><br><span class="line">                    &#125;</span><br><span class="line">                    String[] urlSplit = url.split(&quot;:&quot;);</span><br><span class="line">                    if (urlSplit.length == 2) &#123;</span><br><span class="line">                        SERVER_HOST = url;</span><br><span class="line">                        SERVER_PORT = 58585;</span><br><span class="line">                    &#125; else if (urlSplit.length == 3) &#123;</span><br><span class="line">                        SERVER_HOST = urlSplit[0] + &quot;:&quot; + urlSplit[1];</span><br><span class="line">                        SERVER_PORT = Integer.valueOf(urlSplit[2]);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        Toast.makeText(getApplicationContext(), &quot;URL不合法&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        return false;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    SERVER_HOST = SERVER_FIX_HOST;</span><br><span class="line">                    SERVER_PORT = 58585;</span><br><span class="line">                &#125;</span><br><span class="line">                SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;</span><br><span class="line"></span><br><span class="line">                SPStaticUtils.put(TAG_URL, SERVER_URL);</span><br><span class="line">                SPStaticUtils.put(TAG_HOST, SERVER_HOST);</span><br><span class="line">                SPStaticUtils.put(TAG_PORT, SERVER_PORT);</span><br><span class="line">                if (mEditText.getVisibility() == View.GONE) &#123;</span><br><span class="line">                    Toast.makeText(mApplication, SERVER_URL + &quot; 已生效&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line">                &#125;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        mButtonSend.setOnLongClickListener(new View.OnLongClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onLongClick(View v) &#123;</span><br><span class="line">//                SERVER_HOST = SERVER_FIX_HOST;</span><br><span class="line">//                SERVER_PORT = 58585;</span><br><span class="line">//                SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;</span><br><span class="line">//                Toast.makeText(mApplication, SERVER_URL + &quot;已重置服务器地址&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line"></span><br><span class="line">                toggleServer(false);</span><br><span class="line">                finish();</span><br><span class="line">                android.os.Process.killProcess(android.os.Process.myPid());</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        setBrocastReceiver();</span><br><span class="line"></span><br><span class="line">        setIntentFilter();</span><br><span class="line"></span><br><span class="line">        toggleServer(true);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onStart() &#123;</span><br><span class="line">        super.onStart();</span><br><span class="line">        PhoneCallReceiver.setOnRingListener(new PhoneCallReceiver.OnRingListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onIncomingCallReceived(Context ctx, String number, Date start) &#123;</span><br><span class="line">                sendIncomingRingMsg(number.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;-&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onIncomingCallAnswered(Context ctx, String number, Date start) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onIncomingCallEnded(Context ctx, String number, Date start, Date end) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onOutgoingCallStarted(Context ctx, String number, Date start) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onOutgoingCallEnded(Context ctx, String number, Date start, Date end) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onMissedCall(Context ctx, String number, Date start) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onResume() &#123;</span><br><span class="line">        super.onResume();</span><br><span class="line">        Logger.i(&quot;MainActivity RESUME&quot;);</span><br><span class="line">        registerReceiver(mSMCommingReceiver, mSMSIntentFilter);</span><br><span class="line">        registerReceiver(mScreenReceiver, mScreenIntentFilter);</span><br><span class="line">        registerReceiver(mBatteryReceiver, mBatteryFilter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onPause() &#123;</span><br><span class="line">        super.onPause();</span><br><span class="line">        Logger.i(&quot;MainActivity PAUSE&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onStop() &#123;</span><br><span class="line">        super.onStop();</span><br><span class="line">        Logger.i(&quot;MainActivity STOP&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onDestroy() &#123;</span><br><span class="line">        super.onDestroy();</span><br><span class="line">        Logger.i(&quot;MainActivity DESTORY&quot;);</span><br><span class="line">        unregisterReceiver(mSMCommingReceiver);</span><br><span class="line">        unregisterReceiver(mScreenReceiver);</span><br><span class="line">        unregisterReceiver(mBatteryReceiver);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setBrocastReceiver() &#123;</span><br><span class="line">        mSMCommingReceiver = new BroadcastReceiver() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onReceive(Context context, Intent intent) &#123;</span><br><span class="line">                String msg_from = &quot;&quot;;</span><br><span class="line">                StringBuilder msgBodyStringBuilder = new StringBuilder(200);</span><br><span class="line">                Bundle bundle = intent.getExtras();</span><br><span class="line">                SmsMessage[] msgs;</span><br><span class="line">                if (bundle != null) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Object[] pdus = (Object[]) bundle.get(&quot;pdus&quot;);</span><br><span class="line">                        assert pdus != null;</span><br><span class="line">                        msgs = new SmsMessage[pdus.length];</span><br><span class="line">                        for (int i = 0; i &lt; msgs.length; i++) &#123;</span><br><span class="line">                            msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);</span><br><span class="line">                            msg_from = msgs[i].getOriginatingAddress();</span><br><span class="line">                            msgBodyStringBuilder.append(msgs[i].getMessageBody());</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        String name = SMSAplication.sPhoneContactMap</span><br><span class="line">                                .get(msg_from.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;-&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;));</span><br><span class="line">                        if (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">                            msgBodyStringBuilder.insert(0, name + &quot;-&gt; &quot;);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        String content = msg_from + &quot;\n&quot; + msgBodyStringBuilder.toString();</span><br><span class="line">                        //回应飞信消息</span><br><span class="line">                        if (content.contains(&quot;%YG8Cf^17R*GqzVfxXHP2e&quot;) &amp;&amp; content.contains(&quot;查询手机状态信息&quot;)) &#123;</span><br><span class="line">                            sendStatusMsg();</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if (content.contains(&quot;s*Yfb3SdXy9ruUBK8R!gZX&quot;) &amp;&amp; content.contains(&quot;设置网络&quot;)) &#123;</span><br><span class="line">                            setNetMsg(content);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        send(MSG_NET_SEND,</span><br><span class="line">                                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyStringBuilder.toString())));</span><br><span class="line">                    &#125; catch (Exception e) &#123;</span><br><span class="line">                        Logger.e(e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        mScreenReceiver = new BroadcastReceiver() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onReceive(Context context, Intent intent) &#123;</span><br><span class="line">                Logger.i(intent.getAction());</span><br><span class="line">                if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) &#123;</span><br><span class="line">                    Intent starKeepActivityIntent = new Intent(MainActivity.this, KeepLiveActivity.class);</span><br><span class="line">                    startActivity(starKeepActivityIntent);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        mBatteryReceiver = new BroadcastReceiver() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onReceive(Context context, Intent batteryIntent) &#123;</span><br><span class="line">                Logger.i(batteryIntent.getAction());</span><br><span class="line">                if (batteryIntent.getAction().equals(Intent.ACTION_BATTERY_LOW)) &#123;</span><br><span class="line">                    sendStatusMsg();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setAllowNetWorkMainThread() &#123;</span><br><span class="line">        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();</span><br><span class="line">        StrictMode.setThreadPolicy(policy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setNetMsg(String msg) &#123;</span><br><span class="line">        String msg_from = &quot;66666666&quot;;</span><br><span class="line">        String msgBodyString = &quot;设置网络 &quot;;</span><br><span class="line">        if (msg.contains(&quot;4G&quot;)) &#123;</span><br><span class="line">            msgBodyString += &quot;4G&quot;;</span><br><span class="line">            ConnectivityUtils.setWifi(false);</span><br><span class="line">        &#125; else if (msg.contains(&quot;WIFI&quot;)) &#123;</span><br><span class="line">            msgBodyString += &quot;WIFI&quot;;</span><br><span class="line">            ConnectivityUtils.setWifi(true);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            msgBodyString += &quot;NONE&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        String content = msg_from + &quot;\n&quot; + msgBodyString;</span><br><span class="line">        Logger.i(content);</span><br><span class="line">        send(MSG_NET_SEND,</span><br><span class="line">                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void sendStatusMsg() &#123;</span><br><span class="line">        String msg_from = &quot;88888888&quot;;</span><br><span class="line">        String msgBodyString = &quot;当前电量 &quot; + CommonUtils.getBatteryLevel() + &quot; %&quot;;</span><br><span class="line">        msgBodyString += &quot;\n网络信息 &quot; + ConnectivityUtils.getConnectedInfo(SMSAplication.mApplication);</span><br><span class="line">        msgBodyString += &quot;\n连通信息 &quot; + ConnectivityUtils.isOnline2();</span><br><span class="line">        String content = msg_from + &quot;\n&quot; + msgBodyString;</span><br><span class="line">        Logger.i(content);</span><br><span class="line">        send(MSG_NET_SEND,</span><br><span class="line">                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void sendIncomingRingMsg(String number) &#123;</span><br><span class="line">        String msg_from = number;</span><br><span class="line">        String msgBodyString = &quot;【来电提醒】 &quot; + number;</span><br><span class="line"></span><br><span class="line">        String name = SMSAplication.sPhoneContactMap.get(number);</span><br><span class="line">        if (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">            msgBodyString = &quot;【来电提醒】-&gt;&quot; + name;</span><br><span class="line">        &#125;</span><br><span class="line">        String content = msg_from + &quot;\n&quot; + msgBodyString;</span><br><span class="line">        Logger.i(content);</span><br><span class="line">        send(MSG_NET_SEND,</span><br><span class="line">                new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setIntentFilter() &#123;</span><br><span class="line">        mSMSIntentFilter = new IntentFilter(&quot;android.provider.Telephony.SMS_RECEIVED&quot;);</span><br><span class="line">        mSMSIntentFilter.setPriority(1000);</span><br><span class="line"></span><br><span class="line">        mScreenIntentFilter = new IntentFilter(Intent.ACTION_SCREEN_OFF);</span><br><span class="line">        mScreenIntentFilter.setPriority(1000);</span><br><span class="line"></span><br><span class="line">        mBatteryFilter = new IntentFilter(Intent.ACTION_BATTERY_LOW);</span><br><span class="line">        mBatteryFilter.setPriority(1000);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void toggleServer(boolean start) &#123;</span><br><span class="line">        Intent serverIntent = new Intent(getApplicationContext(), KeepLiveServer.class);</span><br><span class="line">        serverIntent.putExtra(&quot;status&quot;, start ? &quot;start&quot; : &quot;stop&quot;);</span><br><span class="line">        startService(serverIntent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private void send(int what, ShortMessageBean shortMessageBean) &#123;</span><br><span class="line">        Message message = mHandler.obtainMessage(what);</span><br><span class="line">        message.obj = shortMessageBean;</span><br><span class="line">        message.sendToTarget();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void send(int what, int delay, ShortMessageBean shortMessageBean) &#123;</span><br><span class="line">        Message message = new Message();</span><br><span class="line">        message.what = what;</span><br><span class="line">        message.obj = shortMessageBean;</span><br><span class="line">        mHandler.sendMessageDelayed(message, delay);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 由本机发送</span><br><span class="line">     *</span><br><span class="line">     * @param content sms content</span><br><span class="line">     */</span><br><span class="line">    synchronized private void sendByPhone(String content) &#123;</span><br><span class="line">        int nowDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);</span><br><span class="line">        if (nowDay != SMSAplication.sCurrentDay) &#123;</span><br><span class="line">            SMSAplication.sSMSByPhoneTodayCount = 0;</span><br><span class="line">            SMSAplication.sCurrentDay = nowDay;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //如果使用短信，每天发送超过10条</span><br><span class="line">        if (SMSAplication.sSMSByPhoneTodayCount &gt; SMSAplication.MAX_SMS_BY_PHONE_COUNT) &#123;</span><br><span class="line">            addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +</span><br><span class="line">                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;使用短信发送超过每日限制 !!!!!!\n&quot;</span><br><span class="line">                    + content);</span><br><span class="line">            Logger.e(&quot;使用短信发送超过每日限制 : &quot; + content);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 如果是验证码短信则本机发送</span><br><span class="line">        if ((content.contains(&quot;动态&quot;) || content.contains(&quot;验证&quot;)) &amp;&amp; (!content.contains(&quot;Test__&quot;))) &#123;</span><br><span class="line">            if (TextUtils.isEmpty(SMSAplication.sCurrentPhoneNum)) &#123;</span><br><span class="line">                CommonUtils.sendLongSMS(SMSAplication.S_PHONE_NUMBER_POOLS[0], content);</span><br><span class="line">                addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +</span><br><span class="line">                        mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;验证码使用短信发送 !!!!!!\n&quot;</span><br><span class="line">                        + content);</span><br><span class="line">                Logger.e(&quot;验证码使用短信发送: &quot; + content);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                for (String num : SMSAplication.S_PHONE_NUMBER_POOLS) &#123;</span><br><span class="line">                    if (!SMSAplication.sCurrentPhoneNum.contains(num)) &#123;</span><br><span class="line">                        CommonUtils.sendLongSMS(num, content);</span><br><span class="line">                        addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +</span><br><span class="line">                                mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;验证码使用短信发送 !!!!!!\n&quot;</span><br><span class="line">                                + content);</span><br><span class="line">                        Logger.e(&quot;验证码使用短信发送: &quot; + content);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            SMSAplication.sSMSByPhoneTodayCount++;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            addTextViewMessage(mSMSlogTextView, ABNORMAL_DIVIDER +</span><br><span class="line">                    mSimpleDateFormat.format(new Date()) + &quot;--&gt;  &quot; + &quot;非验证码不使用短信发送 !!!!!!\n&quot;</span><br><span class="line">                    + content);</span><br><span class="line">            Logger.e(&quot;非验证码不使用短信发送 : &quot; + content);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onBackPressed() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void clear(View view) &#123;</span><br><span class="line">        mSMSlogTextView.setText(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void checkClearScreen() &#123;</span><br><span class="line">        int nowDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);</span><br><span class="line">        if (nowDay != currentDay) &#123;</span><br><span class="line">            mSMSlogTextView.setText(&quot;&quot;);</span><br><span class="line">            currentDay = nowDay;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void stimulateSend(View view) &#123;</span><br><span class="line">        String msg_from = TEST_SMS_FROM[new Random().nextInt(TEST_SMS_FROM.length)];</span><br><span class="line">        String msgBodyString = TEST_SMS_BODY[new Random().nextInt(TEST_SMS_BODY.length)];</span><br><span class="line">        String content = msg_from + &quot;\n&quot; + msgBodyString;</span><br><span class="line">        ShortMessageBean shortMessageBean = new ShortMessageBean(content, EncryptUtils.encrypt(msg_from, msgBodyString));</span><br><span class="line">        send(MSG_NET_SEND, shortMessageBean);</span><br><span class="line">        Toast.makeText(mApplication, &quot;模拟接收到短信&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void addTextViewMessage(TextView mTextView, String msg) &#123;</span><br><span class="line">        mTextView.append(msg);</span><br><span class="line">        final int scrollAmount =</span><br><span class="line">                mTextView.getLayout().getLineTop(mTextView.getLineCount()) - mTextView.getHeight();</span><br><span class="line">        if (scrollAmount &gt; 0)</span><br><span class="line">            mTextView.scrollTo(0, scrollAmount);</span><br><span class="line">        else</span><br><span class="line">            mTextView.scrollTo(0, 0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SMSAplication.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">public class SMSAplication extends Application &#123;</span><br><span class="line">    public static Application mApplication;</span><br><span class="line">    public static final String SERVER_FIX_HOST = &quot;https://m.xiaoming666.ml&quot;;</span><br><span class="line">    public static String SERVER_HOST = SERVER_FIX_HOST;</span><br><span class="line">    public static int SERVER_PORT = 58585;</span><br><span class="line">    public static String SERVER_PATH = &quot;/Cbu8xatUFAAjqbS33bduWNuxpEe9fJGZ/api/push_sms&quot;;</span><br><span class="line">    public static String SERVER_URL = SERVER_HOST + &quot;:&quot; + SERVER_PORT + SERVER_PATH;</span><br><span class="line"></span><br><span class="line">    public static String TAG_HOST = &quot;TAG_HOST&quot;;</span><br><span class="line">    public static String TAG_PORT = &quot;TAG_PORT&quot;;</span><br><span class="line">    public static String TAG_URL = &quot;TAG_URL&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static HashMap&lt;String, String&gt; sPhoneContactMap;</span><br><span class="line">    public static String sCurrentPhoneNum;</span><br><span class="line">    public final static String[] S_PHONE_NUMBER_POOLS = &#123;&quot;17625756770&quot;, &quot;13926520602&quot;&#125;;</span><br><span class="line">    public final static int MAX_SMS_BY_PHONE_COUNT = 10;</span><br><span class="line">    volatile public static int sSMSByPhoneTodayCount = 0; // 没网状态每天最多发送10条验证码短信</span><br><span class="line">    volatile public static int sCurrentDay = Calendar.getInstance().get(Calendar.DAY_OF_MONTH);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static final int MAX_RETRY_COUNT = 6;</span><br><span class="line">    public static final int RETRY_INTERVAL = 2000;</span><br><span class="line"></span><br><span class="line">    public static final String NORMAL_DIVIDER = &quot;\n----------------------------------\n&quot;;</span><br><span class="line">    public static final String ABNORMAL_DIVIDER = &quot;\n************************************\n&quot;;</span><br><span class="line">    public static final String TEST_SMS_FROM[] = &#123;</span><br><span class="line">            &quot;10086&quot;, &quot;10690691036509&quot;, &quot;10584156&quot;,</span><br><span class="line">            &quot;10086&quot;, &quot;10690691036509&quot;, &quot;10584156&quot;&#125;;</span><br><span class="line">    public static final String TEST_SMS_BODY[] = &#123;</span><br><span class="line">            &quot;Test__尊敬的客户：您当前账户余额19.57元，下一个月结日为2017年07月01日。如需充值可点击 http://gd.10086.cn/cz 。【中国移动】&quot;,</span><br><span class="line">            &quot;Test__【百度】588662 (动态验证码),请在30分钟内填写&quot;,</span><br><span class="line">            &quot;Test__【新浪网】感谢您选择新浪云。接下来的日子，我们将全力协助您，并与您携手一起用技术和创意改变世界！，退订回T&quot;,</span><br><span class="line">            &quot;Test__【平台机器人】您的验证码是：981348（十分钟内有效）。请不要把验证码泄露给其他人。&quot;,</span><br><span class="line">            &quot;Test__【美团网】506820（换绑手机验证码）。工作人员不会向您索要，请勿向任何人泄露。&quot;,</span><br><span class="line">            &quot;Test__【每日优鲜】&lt;满59减30&gt;红包送你！超级会员周，会员专享商品最高直降30元，还不快抢→ http://t.cn/Ra20SNB 退订TD&quot;,</span><br><span class="line">            &quot;Test__每周五上午10点，持浦发银行卡在食行生鲜APP平台充值并在线支付，即可享受满100元返50元优惠&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    public static OkHttpClient client = new OkHttpClient.Builder()</span><br><span class="line">            .connectTimeout(6, TimeUnit.SECONDS)</span><br><span class="line">            .writeTimeout(6, TimeUnit.SECONDS)</span><br><span class="line">            .readTimeout(6, TimeUnit.SECONDS)</span><br><span class="line">            .retryOnConnectionFailure(false)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    public static final MediaType JSON</span><br><span class="line">            = MediaType.parse(&quot;application/json; charset=utf-8&quot;);</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        super.onCreate();</span><br><span class="line">        mApplication = this;</span><br><span class="line">        setLogger();</span><br><span class="line">        new Thread(new Runnable() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                sPhoneContactMap = CommonUtils.getAllContactInfo();</span><br><span class="line">                TelephonyManager tMgr = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);</span><br><span class="line">                sCurrentPhoneNum = tMgr.getLine1Number();</span><br><span class="line">                if (!TextUtils.isEmpty(sCurrentPhoneNum)) &#123;</span><br><span class="line">                    sCurrentPhoneNum = sCurrentPhoneNum.replace(&quot; &quot;, &quot;&quot;)</span><br><span class="line">                            .replace(&quot;+86&quot;, &quot;&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        String host = SPStaticUtils.getString(TAG_HOST);</span><br><span class="line">        int port = SPStaticUtils.getInt(TAG_PORT);</span><br><span class="line">        String url = SPStaticUtils.getString(TAG_URL);</span><br><span class="line">        if (TextUtils.isEmpty(url)) &#123;</span><br><span class="line">            SPStaticUtils.put(TAG_URL, SERVER_URL);</span><br><span class="line">            SPStaticUtils.put(TAG_HOST, SERVER_HOST);</span><br><span class="line">            SPStaticUtils.put(TAG_PORT, SERVER_PORT);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            SERVER_HOST = host;</span><br><span class="line">            SERVER_PORT = port;</span><br><span class="line">            SERVER_URL = url;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void setLogger() &#123;</span><br><span class="line">        Logger.addLogAdapter(new AndroidLogAdapter());</span><br><span class="line">        Logger.addLogAdapter(new AndroidLogAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean isLoggable(int priority, String tag) &#123;</span><br><span class="line">                return BuildConfig.DEBUG;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        FormatStrategy formatStrategy = PrettyFormatStrategy.newBuilder()</span><br><span class="line">                .showThreadInfo(true)  // (Optional) Whether to show thread info or not. Default true</span><br><span class="line">                .methodCount(2)         // (Optional) How many method line to show. Default 2</span><br><span class="line">                .methodOffset(0)        // (Optional) Hides internal method calls up to offset. Default 5</span><br><span class="line">                .tag(&quot;PeoceWang&quot;)   // (Optional) Global tag for every log. Default PRETTY_LOGGER</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        Logger.addLogAdapter(new AndroidLogAdapter(formatStrategy));</span><br><span class="line">        Logger.addLogAdapter(new DiskLogAdapter());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>EncryptUtils.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">public class EncryptUtils &#123;</span><br><span class="line">    private static String s_AES_KEY = &quot;0@NSfpy#L9@ec%NZyZ7Jz5mD@xI$B#2r&quot;;</span><br><span class="line">    private static String a_AES_IV = &quot;6aStDl7YrB4CM3gq&quot;;</span><br><span class="line"></span><br><span class="line">    private static String OBSCURE_KEY[] = &#123;&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;,</span><br><span class="line">            &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;, &quot;L&quot;, &quot;M&quot;,</span><br><span class="line">            &quot;N&quot;, &quot;O&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;R&quot;, &quot;S&quot;, &quot;T&quot;, &quot;U&quot;, &quot;V&quot;, &quot;W&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;,</span><br><span class="line">            &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;,</span><br><span class="line">            &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;,</span><br><span class="line">            &quot;+&quot;, &quot;=&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    private static String OBSCURE_VALUE1[] = &#123;&quot;a&quot;, &quot;Z&quot;, &quot;=&quot;, &quot;I&quot;, &quot;j&quot;, &quot;w&quot;, &quot;9&quot;, &quot;B&quot;, &quot;v&quot;, &quot;+&quot;, &quot;f&quot;, &quot;g&quot;, &quot;1&quot;, &quot;6&quot;, &quot;y&quot;, &quot;N&quot;, &quot;C&quot;, &quot;4&quot;, &quot;k&quot;, &quot;t&quot;, &quot;O&quot;, &quot;m&quot;, &quot;e&quot;,</span><br><span class="line">            &quot;l&quot;,</span><br><span class="line">            &quot;q&quot;, &quot;3&quot;, &quot;R&quot;, &quot;u&quot;, &quot;8&quot;, &quot;7&quot;, &quot;S&quot;, &quot;2&quot;, &quot;Q&quot;, &quot;0&quot;, &quot;P&quot;, &quot;c&quot;, &quot;5&quot;, &quot;H&quot;, &quot;r&quot;, &quot;G&quot;, &quot;E&quot;, &quot;b&quot;, &quot;J&quot;, &quot;W&quot;, &quot;o&quot;, &quot;M&quot;, &quot;K&quot;,</span><br><span class="line">            &quot;i&quot;,</span><br><span class="line">            &quot;U&quot;, &quot;x&quot;, &quot;L&quot;, &quot;V&quot;, &quot;z&quot;, &quot;F&quot;, &quot;Y&quot;, &quot;n&quot;, &quot;X&quot;, &quot;A&quot;, &quot;p&quot;, &quot;T&quot;, &quot;s&quot;, &quot;D&quot;, &quot;d&quot;, &quot;h&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    private static String OBSCURE_VALUE2[] = &#123;&quot;i&quot;, &quot;z&quot;, &quot;+&quot;, &quot;1&quot;, &quot;M&quot;, &quot;y&quot;, &quot;t&quot;, &quot;Z&quot;, &quot;e&quot;, &quot;C&quot;, &quot;3&quot;, &quot;6&quot;, &quot;w&quot;, &quot;D&quot;, &quot;5&quot;, &quot;O&quot;, &quot;o&quot;, &quot;L&quot;, &quot;v&quot;, &quot;u&quot;, &quot;0&quot;, &quot;P&quot;, &quot;j&quot;,</span><br><span class="line">            &quot;Q&quot;,</span><br><span class="line">            &quot;Y&quot;, &quot;s&quot;, &quot;U&quot;, &quot;G&quot;, &quot;B&quot;, &quot;A&quot;, &quot;x&quot;, &quot;m&quot;, &quot;h&quot;, &quot;F&quot;, &quot;T&quot;, &quot;q&quot;, &quot;p&quot;, &quot;W&quot;, &quot;8&quot;, &quot;I&quot;, &quot;d&quot;, &quot;n&quot;, &quot;H&quot;, &quot;4&quot;, &quot;f&quot;, &quot;a&quot;, &quot;c&quot;,</span><br><span class="line">            &quot;V&quot;,</span><br><span class="line">            &quot;=&quot;, &quot;E&quot;, &quot;b&quot;, &quot;9&quot;, &quot;S&quot;, &quot;2&quot;, &quot;l&quot;, &quot;r&quot;, &quot;k&quot;, &quot;N&quot;, &quot;K&quot;, &quot;X&quot;, &quot;J&quot;, &quot;7&quot;, &quot;R&quot;, &quot;g&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    private static String OBSCURE_VALUE3[] = &#123;&quot;A&quot;, &quot;3&quot;, &quot;F&quot;, &quot;=&quot;, &quot;Z&quot;, &quot;c&quot;, &quot;T&quot;, &quot;p&quot;, &quot;s&quot;, &quot;L&quot;, &quot;i&quot;, &quot;+&quot;, &quot;5&quot;, &quot;7&quot;, &quot;j&quot;, &quot;R&quot;, &quot;l&quot;, &quot;d&quot;, &quot;q&quot;, &quot;I&quot;, &quot;m&quot;, &quot;D&quot;, &quot;h&quot;,</span><br><span class="line">            &quot;M&quot;,</span><br><span class="line">            &quot;P&quot;, &quot;U&quot;, &quot;x&quot;, &quot;z&quot;, &quot;W&quot;, &quot;8&quot;, &quot;K&quot;, &quot;S&quot;, &quot;E&quot;, &quot;0&quot;, &quot;Q&quot;, &quot;X&quot;, &quot;r&quot;, &quot;e&quot;, &quot;2&quot;, &quot;k&quot;, &quot;6&quot;, &quot;g&quot;, &quot;1&quot;, &quot;9&quot;, &quot;O&quot;, &quot;J&quot;, &quot;V&quot;,</span><br><span class="line">            &quot;f&quot;,</span><br><span class="line">            &quot;t&quot;, &quot;N&quot;, &quot;Y&quot;, &quot;o&quot;, &quot;H&quot;, &quot;v&quot;, &quot;w&quot;, &quot;n&quot;, &quot;G&quot;, &quot;4&quot;, &quot;u&quot;, &quot;B&quot;, &quot;C&quot;, &quot;a&quot;, &quot;y&quot;, &quot;b&quot;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    private static ArrayMap OBSCURE_MAP1 = new ArrayMap();</span><br><span class="line">    private static ArrayMap OBSCURE_MAP2 = new ArrayMap();</span><br><span class="line">    private static ArrayMap OBSCURE_MAP3 = new ArrayMap();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private static final int[] INSERT_POSITION = &#123;0, 5, 7, 9, 22, 30, 31, 35, 39, 42&#125;;</span><br><span class="line">    private static final int[] INSERT_MSG_LEN = &#123;7, 12, 10, 6, 9, 6, 10, 8, 9, 4&#125;;</span><br><span class="line">    private static ArrayMap&lt;Integer, Integer&gt; POS_LEN_MAP = new ArrayMap();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        int len = OBSCURE_KEY.length;</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            OBSCURE_MAP1.put(OBSCURE_KEY[i], OBSCURE_VALUE1[i]);</span><br><span class="line">            OBSCURE_MAP2.put(OBSCURE_KEY[i], OBSCURE_VALUE2[i]);</span><br><span class="line">            OBSCURE_MAP3.put(OBSCURE_KEY[i], OBSCURE_VALUE3[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        len = INSERT_POSITION.length;</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            POS_LEN_MAP.put(INSERT_POSITION[i], INSERT_MSG_LEN[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String encrypt(String from, String body) &#123;</span><br><span class="line">        ArrayMap&lt;String, String&gt; arrayMap = new ArrayMap(2);</span><br><span class="line">        arrayMap.put(&quot;FROM&quot;, from);</span><br><span class="line">        arrayMap.put(&quot;BODY&quot;, body);</span><br><span class="line">        try &#123;</span><br><span class="line">            return obscureString(getBase64Encode(map2Json(arrayMap).toString()));</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;ENCRYPT ERROR!!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private static String getBase64Encode(String plainStr) &#123;</span><br><span class="line">        return Base64.encodeToString(plainStr.getBytes(), Base64.NO_WRAP);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String replaceChar(String plainString, ArrayMap arrayMap) &#123;</span><br><span class="line">        StringBuilder stringBuilder = new StringBuilder();</span><br><span class="line">        int stringLen = plainString.length();</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; stringLen; i++) &#123;</span><br><span class="line">            String c = String.valueOf(plainString.charAt(i));</span><br><span class="line">            if (arrayMap.containsKey(c)) &#123;</span><br><span class="line">                stringBuilder.append(arrayMap.get(c));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                stringBuilder.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String getRandomString(int len) &#123;</span><br><span class="line">        StringBuilder stringBuilder = new StringBuilder(len);</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            stringBuilder.append((char) (&apos;(&apos; + new Random().nextInt(50)));</span><br><span class="line">        &#125;</span><br><span class="line">        return stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String addReduceChar(String plainString) &#123;</span><br><span class="line">        StringBuilder stringBuilder = new StringBuilder(plainString);</span><br><span class="line">        for (int pos : INSERT_POSITION) &#123;</span><br><span class="line">            stringBuilder.insert(pos, getRandomString(POS_LEN_MAP.get(pos)));</span><br><span class="line">        &#125;</span><br><span class="line">        return stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String removeReduceChar(String plainString) &#123;</span><br><span class="line">        StringBuilder stringBuilder = new StringBuilder(plainString);</span><br><span class="line">        int len = INSERT_POSITION.length;</span><br><span class="line">        for (int i = len - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">            String firstStr = stringBuilder.substring(0, INSERT_POSITION[i]);</span><br><span class="line">            String secondStr = stringBuilder.substring(INSERT_POSITION[i] + INSERT_MSG_LEN[i], stringBuilder.length());</span><br><span class="line">            stringBuilder = new StringBuilder(firstStr + secondStr);</span><br><span class="line">        &#125;</span><br><span class="line">        return stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //   加密过程：</span><br><span class="line">    //   原文--&gt; Json -&gt; Base64--&gt; AES(CBC) --&gt; 一轮字符替换 --&gt; 二轮字符替换  --&gt; 指定位置添加冗余信息 --&gt; 三轮字符替换  --&gt; 密文</span><br><span class="line">    private static String obscureString(String plainString) throws Exception &#123;</span><br><span class="line">        String obsString = aesEncrypt(plainString);</span><br><span class="line">        obsString = replaceChar(obsString, OBSCURE_MAP1);</span><br><span class="line">        obsString = replaceChar(obsString, OBSCURE_MAP2);</span><br><span class="line">        obsString = addReduceChar(obsString);</span><br><span class="line">        obsString = replaceChar(obsString, OBSCURE_MAP3);</span><br><span class="line">        return obsString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String aesEncrypt(String sSrc) throws Exception &#123;</span><br><span class="line">        Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);</span><br><span class="line">        byte[] raw = s_AES_KEY.getBytes();</span><br><span class="line">        SecretKeySpec skeySpec = new SecretKeySpec(raw, &quot;AES&quot;);</span><br><span class="line">        IvParameterSpec iv = new IvParameterSpec(a_AES_IV.getBytes());//使用CBC模式，需要一个向量iv，可增加加密算法的强度</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);</span><br><span class="line">        byte[] encrypted = cipher.doFinal(sSrc.getBytes(&quot;utf-8&quot;));</span><br><span class="line">//        return new BASE64Encoder().encode(encrypted);//此处使用BASE64做转码。</span><br><span class="line">        StringBuilder sb = new StringBuilder();  //此处使用十六进制转码。</span><br><span class="line">        for (byte b : encrypted) &#123;</span><br><span class="line">            sb.append(String.format(&quot;%02X&quot;, b));</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String aesDecrypt(String sSrc) throws Exception &#123;</span><br><span class="line">//        try &#123;</span><br><span class="line">//            byte[] raw = sKey.getBytes(&quot;ASCII&quot;);</span><br><span class="line">//            SecretKeySpec skeySpec = new SecretKeySpec(raw, &quot;AES&quot;);</span><br><span class="line">//            Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);</span><br><span class="line">//            IvParameterSpec iv = new IvParameterSpec(ivParameter.getBytes());</span><br><span class="line">//            cipher.init(Cipher.DECRYPT_MODE, skeySpec, iv);</span><br><span class="line">//            byte[] encrypted1 = new BASE64Decoder().decodeBuffer(sSrc);//先用base64解密</span><br><span class="line">//            byte[] original = cipher.doFinal(encrypted1);</span><br><span class="line">//            String originalString = new String(original, &quot;utf-8&quot;);</span><br><span class="line">//            return originalString;</span><br><span class="line">//        &#125; catch (Exception ex) &#123;</span><br><span class="line">//            return null;</span><br><span class="line">//        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Wechat/">Wechat</a> <a class="tag tag--primary tag--small t-link" href="/tags/双卡功能/">双卡功能</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/22/旧手机短信转发的解决方案（二）/" data-tooltip="旧手机短信转发的解决方案（二）" aria-label="PREVIOUS: 旧手机短信转发的解决方案（二）">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/01/总结排序算法/" data-tooltip="总结排序算法" aria-label="NEXT: 总结排序算法">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Weibo">
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/&amp;title=旧手机短信转发的解决方案（一）" title="Share on QQ">
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>





                

                
                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
		Copyrights &copy; 2020 AndrewWang. All Rights Reserved.
    </span>
</footer>

                

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/22/旧手机短信转发的解决方案（二）/" data-tooltip="旧手机短信转发的解决方案（二）" aria-label="PREVIOUS: 旧手机短信转发的解决方案（二）">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/05/01/总结排序算法/" data-tooltip="总结排序算法" aria-label="NEXT: 总结排序算法">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/" title="Share on Weibo">
                    <i class="fab fa-weibo" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/&amp;title=旧手机短信转发的解决方案（一）" title="Share on QQ">
                    <i class="fab fa-qq" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="2">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/">
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/">
                        <i class="fab fa-weibo" aria-hidden="true"></i><span>Share on Weibo</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://xiaoo.ml/2017/05/22/旧手机短信转发的解决方案（一）/&amp;title=旧手机短信转发的解决方案（一）">
                        <i class="fab fa-qq" aria-hidden="true"></i><span>Share on QQ</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/avatar(7).png" alt="Author&#39;s picture">
        
            <h4 id="about-card-name">AndrewWang</h4>
        
            <div id="about-card-bio"><p>凡是过去，皆为序章<br>须知参差百态，乃是幸福本源<br>邮箱：<a href="mailto:fernando_caudill@outlook.com" target="_blank">fernando_caudill@outlook.com</a></p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>Android+Python</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                Zhangzhou Fujian
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/others/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search" class="form-control input--large search-input" placeholder="Search ">
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2013/01/22/Cloneable和clone的使用，以及深复制与浅复制的区别/">
                            <h3 class="media-heading">Cloneable和clone的使用，以及深复制与浅复制的区别</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jan 22, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><ni>深浅复制总结下</ni></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2013/02/04/Ubuntu Problem/">
                            <h3 class="media-heading">Ubuntu Problem</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Feb 4, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><ni>记录最近几年使用Ubuntu有用的Tips</ni></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2013/08/18/婚后，你一定会遇到更喜欢的人/">
                            <h3 class="media-heading">婚后，你一定会遇到更喜欢的人</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Aug 18, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>结婚后，你一定会遇到更喜欢的人。这件事几乎是肯定的。倒不是说先前结婚的人有多糟糕，也不是说后来出现的人有多美好。而是，你更了解自己了。</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2013/11/09/ImageLoader must be init with configuration before using 错误解决方法/">
                            <h3 class="media-heading">ImageLoader must be init with configuration before using 错误解决方法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Nov 9, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>最近开发过程中用到了开源项目Android-Universal-Image-Loader。<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2013/12/14/把WordPress放在根目录而地址显示子目录的方法/">
                            <h3 class="media-heading">把WordPress放在根目录而地址显示子目录的方法</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 14, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p> 今天在狗爹（GoDaddy）随便买了个域名，想建个个人博客耍耍。<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2014/02/15/越是聪明人，越容易在这件事上栽跟头/">
                            <h3 class="media-heading">越是聪明人，越容易在这件事上栽跟头zt</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Feb 15, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>一篇名为《李开复：聪明人创业为何容易失败》的商业报道里写道，记者问李开复，如何在短时间内对一个创业者或项目进行判断，有哪些指标或者投资方法论？<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2014/04/02/Java中普通代码块，构造代码块，静态代码块区别及代码示例/">
                            <h3 class="media-heading">Java中普通代码块，构造代码块，静态代码块区别及代码示例</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 2, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>执行顺序：（优先级从高到低）静态代码块&gt;main方法&gt;构造代码块&gt;构造方法。其中静态代码块只执行一次。构造代码块在每次创建对象是都会执行。<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2014/04/14/getApplicationContext()、getBasecontext()、getApplication() 区别/">
                            <h3 class="media-heading">getApplicationContext()、getBasecontext()、getApplication() 区别</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 14, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><ni>搞清区别联系很重要，虽然好多情况下能通用的。</ni></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2014/04/24/使用注解来统计算法时间/">
                            <h3 class="media-heading">使用注解统计算法运行时间</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Apr 24, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><p>一直以为注解并没有什么卵用，后来用了butterknift和spring组件后才知道自定义组件可以完成很多任务。<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://xiaoo.ml/2014/05/22/git merge和rebase的区别/">
                            <h3 class="media-heading">git merge和rebase的区别</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    May 22, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><ni>一直以来都以为rebase是合并冲突的一种手段，和merge一样的，用哪个都行。</ni></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium" data-message-zero="no post found" data-message-one="1 post found" data-message-other="{n} posts found">
                78 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->

    


    <script src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/js/moment-with-locales.min.js"></script>
    <script src="https://my-blog-hexo-1253240671.cos.ap-shanghai.myqcloud.com/js/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('NPCJXUJXHV', '519d0ecd5f05b733ac031d89154c7bbb');
        var algoliaIndex = algoliaClient.initIndex('my-hexo-blog');
    </script>


    </body>
</html>
